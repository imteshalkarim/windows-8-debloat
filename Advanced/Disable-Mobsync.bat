@ECHO OFF
WHOAMI | FINDSTR /c:"system" || (
	IF NOT EXIST "%~dp0\NSudo.exe" (
		ECHO NSudo is missing!
		PAUSE > NUL & EXIT
	)
	"%~dp0\NSudo.exe" -U:T -P:E "%~0"
	EXIT
)
CLS

:: FOR SOME REASON, REG DELETE/REG ADD DID NOT WORK!!!

:: DEFAULT VALUE - %SystemRoot%\System32\mobsync.exe

SET "REGISTRY_FILE=%TEMP%\Disable_MobSync.reg"
ECHO Windows Registry Editor Version 5.00 > "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\CLSID\{1202DB60-1DAC-42C5-AED5-1ABDD432248E}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\CLSID\{1A1F4206-0688-4E7F-BE03-D82EC69DF9A5}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\CLSID\{6295DF2D-35EE-11D1-8707-00C04FD93327}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\CLSID\{69F9CB25-25E2-4BE1-AB8F-07AA7CB535E8}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\CLSID\{8D8B8E30-C451-421B-8553-D2976AFA648C}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\CLSID\{B8558612-DF5E-4F95-BB81-8E910B327FB2}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\CLSID\{C947D50F-378E-4FF6-8835-FCB50305244D}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{1202DB60-1DAC-42C5-AED5-1ABDD432248E}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{1A1F4206-0688-4E7F-BE03-D82EC69DF9A5}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{6295DF2D-35EE-11D1-8707-00C04FD93327}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{69F9CB25-25E2-4BE1-AB8F-07AA7CB535E8}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{8D8B8E30-C451-421B-8553-D2976AFA648C}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{B8558612-DF5E-4F95-BB81-8E910B327FB2}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{C947D50F-378E-4FF6-8835-FCB50305244D}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{1202DB60-1DAC-42C5-AED5-1ABDD432248E}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{1A1F4206-0688-4E7F-BE03-D82EC69DF9A5}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{6295DF2D-35EE-11D1-8707-00C04FD93327}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{69F9CB25-25E2-4BE1-AB8F-07AA7CB535E8}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{8D8B8E30-C451-421B-8553-D2976AFA648C}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{B8558612-DF5E-4F95-BB81-8E910B327FB2}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{C947D50F-378E-4FF6-8835-FCB50305244D}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Wow6432Node\CLSID\{1202DB60-1DAC-42C5-AED5-1ABDD432248E}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Wow6432Node\CLSID\{1A1F4206-0688-4E7F-BE03-D82EC69DF9A5}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Wow6432Node\CLSID\{6295DF2D-35EE-11D1-8707-00C04FD93327}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Wow6432Node\CLSID\{69F9CB25-25E2-4BE1-AB8F-07AA7CB535E8}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Wow6432Node\CLSID\{8D8B8E30-C451-421B-8553-D2976AFA648C}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Wow6432Node\CLSID\{B8558612-DF5E-4F95-BB81-8E910B327FB2}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Wow6432Node\CLSID\{C947D50F-378E-4FF6-8835-FCB50305244D}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Classes\CLSID\{1202DB60-1DAC-42C5-AED5-1ABDD432248E}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Classes\CLSID\{1A1F4206-0688-4E7F-BE03-D82EC69DF9A5}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Classes\CLSID\{6295DF2D-35EE-11D1-8707-00C04FD93327}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"
ECHO [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Classes\CLSID\{6295DF2D-35EE-11D1-8707-00C04FD93327}\LocalServer32] >> "%REGISTRY_FILE%"
ECHO @=hex(2):00,00 >> "%REGISTRY_FILE%"

IF EXIST "%REGISTRY_FILE%" (
	REG IMPORT "%REGISTRY_FILE%" > NUL
	DEL "%REGISTRY_FILE%" /F /Q > NUL
)